<style>
  .megamenu__products a,
  .megamenu__products button {
    background: none;
    outline: none;
    border: 0;
    text-decoration: none;
    color: inherit;
    cursor: pointer;
  }
  .megamenu__products {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    height: 450px;
    z-index: 99;
    background: #fff;
    padding: 30px 0;
  }
  .megamenu__products.active {
    display: block;
  }
  .megamenu__products-nav {
    position: relative;
    display: flex;
    justify-content: center;
    list-style-type: none;
  }
  .megamenu__products-nav-btn {
    padding: 10px 20px;
    font-weight: bold;
    text-transform: uppercase;
  }
  .megamenu__products-nav-btn.active {
    color: #99bbe3;
  }
  .megamenu__products-item-show,
  .megamenu__products-items {
    visibility: hidden;
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    display: flex;
    justify-content: center;
    list-style-type: none;
    padding: 10px 20px;
  }
  .megamenu__products-items {
    margin-top: 30px;
  }
  .megamenu__products-item-show {
    top: calc(100% + 20px);
    left: 50%;
    transform: translateX(-50%);
    font-weight: bold;
    text-decoration: underline;
  }
  .megamenu__products-nav-btn.active + .megamenu__products-items .megamenu__products-item-show,
  .megamenu__products-nav-btn.active + .megamenu__products-items {
    visibility: visible;
    transition: 0.3s;
  }
  .megamenu__products-items li {
    max-width: 150px;
    margin: 0 20px;
  }
  .megamenu__products-items li h3 {
    margin-top: 10px;
    text-align: center;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    color: #000;
    font-weight: bold;
  }

  .trigger-drawer-menu {
    width: 50px;
    position: relative;
    z-index: 999;
  }
  .trigger-drawer-menu svg.icon-close {
    display: none;
  }
  .trigger-drawer-menu.active svg.icon-close {
    display: block;
  }
  .trigger-drawer-menu.active svg.icon-menu {
    display: none;
  }
</style>
<menu-with-products class="megamenu__products">
  <ul class="megamenu__products-nav">
    {% for collection in nav_item_collections %}
      <li>
        <button class="megamenu__products-nav-btn active" data-trigger-submenu>
          {{ collection.title }}
        </button>
        <ul class="megamenu__products-items">
          {% for product in collection.products %}
            <li class="megamenu__products-item">
              <a href="{{product.url}}">
                <div class="img-wrapper">
                  <img src="{{product.featured_image |  image_url: width: '150px'}}" alt="">
                </div>
                <h3>
                  {{ product.title }}
                </h3>
              </a>
            </li>
          {% endfor %}
          <li class="megamenu__products-item-show">
            <a href="{{collection.url}}">SHOP All</a>
          </li>
        </ul>
      </li>
      <li>
        <button class="megamenu__products-nav-btn" data-trigger-submenu>
          {{ collection.title }}
        </button>
        <ul class="megamenu__products-items">
          {% for product in collection.products %}
            {% if forloop.index > 1 %}

              <li class="megamenu__products-item">
                <a href="{{product.url}}">
                  <div class="img-wrapper">
                    <img src="{{product.featured_image |  image_url: width: '150px'}}" alt="">
                  </div>
                  <h3>
                    {{ product.title }}
                  </h3>
                </a>
              </li>
            {% endif %}
          {% endfor %}
          <li class="megamenu__products-item-show">
            <a href="{{collection.url}}">SHOP All</a>
          </li>
        </ul>
      </li>
    {% endfor %}
  </ul>
</menu-with-products>
{{ 'menu-with-products.js' | asset_url | script_tag }}